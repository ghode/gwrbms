<!DOCTYPE html>

<script src="js/jquery-3.1.0.min.js" type="text/javascript"></script>
	<script src="js/bootstrap.min.js" type="text/javascript"></script>
	<script src="js/material.min.js" type="text/javascript"></script>
<html>
	<head>
		<meta charset="utf-8" />
		<link rel="apple-touch-icon" sizes="76x76" href="../assets/img/apple-icon.png" />
		<link rel="icon" type="image/png" href="../assets/img/favicon.png" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		
		<title>业务管理</title>
		
		<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
		<meta name="viewport" content="width=device-width" />
		
		
		<!-- Bootstrap core CSS     -->
		<link href="css/bootstrap.min.css" rel="stylesheet" />
		
		<!--  Material Dashboard CSS    -->
		<link href="css/material-dashboard.css" rel="stylesheet"/>
		
	</head>
	<body>
		<html>
<head>
	
 
</body>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
 <title>业务管理</title>
 <script src="js/test.js" type="text/javascript" charset="utf-8"></script>
</head>
<body >
	<div class="wrapper">
	    <div class="main-panel">
	        
	        <div class="col-md-12">
	            <div class="card">
	                <div class="card-header" data-background-color="purple">
	                    <h4 class="title">业务管理</h4>
	                    <p class="category">Discuss here!</p>
	                </div>
	                <div class="card-content table-responsive">
	                    <table class="table" id="table">
	                        <thead class="text-primary">
	                            <tr>
	                             <th>1</th>
	                             <th>2</th>
	                             <th>3</th>
	                             <th>4</th>
	                             <th>5</th>
	                             <th>6</th>
	                             <th>7作</th>
	                            </tr>
	                        </thead>
	                    </table>
					</div>
	            </div>
	        </div>
	    </div>
		
	</div> 
<center>
 <br/><br/>
 

 

 
<div style="display:none" id="addinfo">
<form>
 <br>
 题目编号：<br><input type="text" id="username" /><br><!--限制用户名只能用英文 下划线 或数字-->
 题干：<br><input type="text" id="password"/><br>
 选项A:（只能是汉字）<br><input type="text" id="name"/><br>
 选项B:<br><input type="text" id="email"/><br>
 选项C:<br><input type="text" id="phone"/><br>
 选项D:<br><input type="text" id="qq"/><br>
 正确答案:<br><input type="text" id="uid"/><br><br>
 <input type="button" value="提交" onclick="addInfo()" id="btn_add">
 <input type="button" value="提交" onclick="updateInfo()" style="display:none" id="btn_update">
 <input type="button" value="取消" onclick="hideAddInput()">
</form>
</div>
</center>

	</body>
<script type="text/javascript">
		var row = 0 ; //定义全局行数用于修改
quary();
//----获取行号-----
function getRow(r){
 var i=r.parentNode.parentNode.rowIndex; 
 return i ;
}
//----获取行号-----
 
//----删除某一行-----
function delRow(r){ 
 document.getElementById('table').deleteRow(getRow(r));
}
//----删除某一行-----
 
//----清除添加信息框的内容-----
function cleanAddInput(){
 document.getElementById('username').value='';
 document.getElementById('password').value=''; 
 document.getElementById('name').value='';
 document.getElementById('email').value='';
 document.getElementById('phone').value='';
 document.getElementById('qq').value='';
 document.getElementById('uid').value='';
}
//----清除添加信息框的内容-----
 
//----显示添加信息框-----
function showAddInput(){
 document.getElementById('addinfo').style="display:block-inline" ;
 document.getElementById('btn_add').style="display:block-inline" ;
 document.getElementById('btn_update').style="display:none" ;
 cleanAddInput(); 
}
//----显示添加信息框-----
 
//----隐藏添加信息框-----
function hideAddInput(){
 document.getElementById('addinfo').style="display:none" ;
 
}
//----隐藏添加信息框-----
 
//----判断输入框的信息是否符合要求-----
function judge(){
 //根据id获取表单信息
 var username = document.getElementById('username').value;
 var password = document.getElementById('password').value; 
 var name = document.getElementById('name').value;
 var email = document.getElementById('email').value;
 var phone = document.getElementById('phone').value;
 var qq = document.getElementById('qq').value;
 var uid = document.getElementById('uid').value;
 var judge = true ; //用于判断表单信息是否符合
 
  
 return judge ;
}
//----插入起始数据的方法-----
 var urll = "/quiz/Stu/findstudent";
 function quary() {
 	
 	var queryurl = "/quiz/Sco/query";
 	$.ajax({
 		url:queryurl,
 		type:"GET",
 		dataType:"json",
 		success:function(str){
 			
 			$(str).each(function (index,e){
					var arr = new Array();
					
					arr[0] = e.student_id;
					arr[1] = e.class_id; 
					arr[2] = e.score;
					arr[3] = e.teacher_name;
					arr[4] = e.date;
					arr[5] = 1;
					arr[6] ="<a style='text-align:center;color:blue;cursor:pointer;' onclick='delRow(this);'>重考</a>";
					var x = document.getElementById('table').insertRow(1); //获取第一行对象
					
					for(var i=0;i<arr.length;i++){
					 x.insertCell(i).innerHTML = arr[i] ; //用循环把每个数据插入第一行的每一列
					}
				});
 			
 		},
 		error:function(){
 			alert("ff");
 		}
 		
 	});
 	
 }
//----新增信息的插入方法-----
function insertInfo(){
 //根据id获取表单信息
 var arr = new Array();
 
 arr[0] = document.getElementById('username').value;
 arr[1] = document.getElementById('password').value; 
 arr[2] = document.getElementById('name').value;
 arr[3] = document.getElementById('email').value;
 arr[4] = document.getElementById('phone').value;
 arr[5] = document.getElementById('qq').value;
 arr[6] = document.getElementById('uid').value;
 arr[7] ="<a style='text-align:center;color:blue;cursor:pointer;' onclick='updateRow(this);'>修改</a> <a style='text-align:center;color:blue;cursor:pointer;' onclick='delRow(this);'>删除</a>";
 var x = document.getElementById('table').insertRow(1); //获取第一行对象
  
 for(var i=0;i<arr.length;i++){
  x.insertCell(i).innerHTML = arr[i] ; //用循环把每个数据插入第一行的每一列
 }
  
}
//----新增信息的插入方法-----
 
//----新增信息-----
function addInfo(){
  
 if(judge()==true){
  alert('添加成功');
  insertInfo(); //执行插入
  hideAddInput(); //隐藏添加信息框
   
 }else{
  alert('添加失败');
 }
}
//----新增信息-----
 
 
//----根据行号修改信息-----
function updateRow(r){
 row = getRow(r); //把该行号赋值给全局变量
 showAddInput(); //显示修改表单
 //提交按钮替换
 document.getElementById('btn_add').style="display:none" ;
 document.getElementById('btn_update').style="display:block-inline" ;
 insertInputFromQuery(queryInfoByRow(row));
  
}
//----根据行号修改信息-----
 
 
//----根据行号查信息----
function queryInfoByRow(r){
  
 var arr = new Array();
 for(var m=0 ; m<7;m++){
  arr[m] = document.getElementById('table').rows[row].cells[m].innerText;
 }
 return arr ; //返回该行数据
  
}
//----根据行号查信息----
 
//----把查询到的信息放入修改的表单里----
function insertInputFromQuery(arr){
 document.getElementById('username').value = arr[0];
 document.getElementById('password').value = arr[1];
 document.getElementById('name').value = arr[2];
 document.getElementById('email').value = arr[3];
 document.getElementById('phone').value = arr[4];
 document.getElementById('qq').value = arr[5];
 document.getElementById('uid').value = arr[6];
  
}
//----把查询到的信息放入修改的表单里----
 
 
function updateInfo(){
 if(judge()==true){
  alert('修改成功');
  document.getElementById('table').deleteRow(row);//删除原来那行  
  insertInfo(); //插入修改后的值
  hideAddInput(); //隐藏添加模块
 }else{
  alert('修改失败');
  hideAddInput();
 }
}

	
function  aaa(){
	alert("111");
}
	</script>
</html>
