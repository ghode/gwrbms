<!--
  ~ Copyright (c) 2019. The copyright is reserved by Ghode of Harbin Institute
  ~ of Technology. Users are free to copy, change or remove. Because no one
  ~ will read this. Only I know is that Repeaters are the best of the world.
  ~ Only I know is that Repeaters are the best of the world. Only I know is
  ~ that Repeaters are the best of the world. Maybe a long copyright text
  ~ seems professional. Therefore this text will be a bit lengthy. However,
  ~ the author seems to be afraid that one day, this text may be uploaded to
  ~ business projects. That is the time you can contact with author via email
  ~ ghode@cirnocraft.im or directly ignore this, which will be interesting.
  -->

<!DOCTYPE html>
<html>
<head>
    <title>Login</title>
    <meta charset="utf-8">
    <link href="css/style.css" rel='stylesheet' type='text/css'/>
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <script type="application/x-javascript"> addEventListener("load", function () {
        setTimeout(hideURLbar, 0);
    }, false);

    function hideURLbar() {
        window.scrollTo(0, 1);
    } </script>
</head>
<style>

</style>

<body>

<!-----start-main---->

<div class="main">
    <div class="login-form">
        <h1>通用批发零售业务管理系统 </h1>
        <h1>用户登录</h1>


        <form action="/account/login/log" method="GET">

            <input class="text" id="username" name="username"
                   onblur="if (this.value == '') {this.value = '用户名';}"
                   onfocus="this.value = '';" type="text"
                   value="用户名">
            <input id="password" name="password"
                   onblur="if (this.value == '') {this.value = '000000';}"
                   onfocus="this.value = '';"
                   type="password"
                   value="000000">
            <div class="submit">
                用户类型&nbsp;&nbsp;&nbsp;
                <select class="form-control" id="sel" name="type">
                    <option value = 1>店员</option>
                    <option value = 2>店长</option>
                    <option value = 3>经理</option>
                </select>

                <br>
                .
                <input type="submit" value="登录" id="sub" name="sub">

            </div>
            <!-- <p><a href="#">Forgot Password ?</a></p> -->
        </form>
    </div>
</div>
<!-----//end-main---->


<script src = "js/jquery-3.2.1.js"></script>
<script type="text/javascript">
    $("#sub").click(function () {
        var username = $.trim($("#username").val());
        var password = $.trim($("#password").val());
        var type = $.trim($("#sel").val());
        if (username == "") {
            alert("请输入用户名");
            return false;
        } else if (password == "") {
            alert("请输入密码");
            return false;
        }
        var data= {username:username,password:password,type:type};
        $.ajax(
            {
                type: 'POST',
                url: 'account/login/',
                data: data,
                dataType: 'json',
                success:function(msg){
                    //alert(msg);
                    if(msg === "success"){
                        if(type == 1){
                            window.location.href = "clerk/ClerkIndex.html";
                        }
                        else if(type == 2){
                            window.location.href = "shopkeeper/ShopkeeperIndex.html";
                        }
                        else {
                            window.location.href = "manager/ManagerIndex.html";
                        }
                    }else{
                        alert("登录失败，请重试!");
                    }
                }
            }
        );

    });
</script>
</body>

</html>